<!DOCTYPE html>
<html layout:decorate="~{index}">

<head>
    <title>회원가입</title>
    <style>
        .form-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-top: 150px;
            margin-bottom: 60px;
        }
    </style>
    <script>
	function checkLoginId() {
	    const userId = document.getElementById('userId').value;
	
	    fetch(`/user/checkUserId?userId=${encodeURIComponent(userId)}`, {
	        method: 'GET',
	        headers: {
	            'Content-Type': 'application/json'
	        }
	    })
	    .then(response => response.json())
	    .then(data => {
	        if (data.exists) {
	            document.getElementById('checkResult').innerText = '이미 사용 중인 아이디입니다.';
	        } else {
	            document.getElementById('checkResult').innerText = '사용 가능한 아이디입니다.';
	        }
	    })
	    .catch(error => {
	        console.error('Error:', error);
	        document.getElementById('checkResult').innerText = '중복 확인 중 오류가 발생했습니다.';
	    });
	}
	</script>
</head>

<body class="index-page">
    <div layout:fragment="content" class="container my-5">
        <div class="form-container">
            <h4 class="card-title mb-4 text-center">Sign up</h4>
            <form th:action="@{/user/signup}" method="post" th:object="${userCreateForm}">
                <div class="mb-3">
                    <label for="userId" class="form-label">아이디</label>
                    <input type="text" class="form-control" id="userId" name="userId" th:field="*{userId}" placeholder="아이디 영문 3~25자">
                    <div th:if="${#fields.hasErrors('userId')}" th:errors="*{userId}" class="text-danger mt-2"></div>
                    <button type="button" class="btn btn-secondary" onclick="checkLoginId()">중복확인</button>
					<div id="checkResult" class="validation-message"></div>
					<div id="loginIdValidation" class="validation-message"></div>
				</div>
                <div class="mb-3">
                    <label for="password1" class="form-label">비밀번호</label>
                    <input type="password" th:field="*{password1}" class="form-control" id="password1" placeholder="비밀번호 영문, 숫자, 특수문자 조합 8~12자">
                    <div th:if="${#fields.hasErrors('password1')}" th:errors="*{password1}" class="text-danger mt-2"></div>
                </div>
                <div class="mb-3">
                    <label for="password2" class="form-label">비밀번호 확인</label>
                    <input type="password" th:field="*{password2}" class="form-control" id="password2" placeholder="비밀번호 다시 입력">
                    <div th:if="${#fields.hasErrors('password2')}" th:errors="*{password2}" class="text-danger mt-2"></div>
                </div>
				<div class="mb-3">
				    <label for="name" class="form-label">이름</label>
				    <input type="text" th:field="*{name}" class="form-control" id="name" placeholder="이름 2자 이상">
				    <div th:if="${#fields.hasErrors('name')}" th:errors="*{name}" class="text-danger mt-2"></div>
				</div>
                <div class="mb-3">
                    <label for="email" class="form-label">이메일</label>
                    <input type="email" th:field="*{email}" class="form-control" id="email" placeholder="이메일 입력">
                    <div th:if="${#fields.hasErrors('email')}" th:errors="*{email}" class="text-danger mt-2"></div>
                </div>
                <button type="submit" class="btn btn-primary w-100">회원가입</button>
                <div th:if="${successMessage}" class="alert alert-success mt-3" th:text="${successMessage}"></div>
            </form>
        </div>
	</div>
</body>
</html>